% Reference and Acknowledgement: https://de.wikipedia.org/wiki/MINRES-Verfahrenfunction [x,r] = ls_minres(A,b,x0,maxit,tol)  % Initial guess x0  x = x0;    % Initial residual   r = b - A*x0;    % Initial direction for correcting a better approximation of the solution   p0 = r;    % Image of the initial direction vector for a better approximation of the solution.  % We want to add s0 in such a way to the residual, so we can minimize the risidual.  s0 = A*p0;    % First iteration  p1 = p0;  s1 = s0;    % Iterate to the maximimal iteration  for iter=[1:maxit]    p2 = p1;p1 = p0;    s2 = s1;s1 = s0;    alpha = r'*s1/(s1'*s1);    x += alpha*p1;    r -= alpha*s1;        % If the norm of the residual is smaller than the tolerance, stop algorithm.    if (r'*r < tol^2)      break    end    p0 = s1;    s0 = A*s1;    beta1 = s0'*s1/(s1'*s1);    p0 -= beta1*p1;    s0 -= beta1*s1;    if iter > 1      beta2 = s0'*s2/(s2'*s2);      p0 -= beta2*p2;      s0 -= beta2*s2;    end  end  end